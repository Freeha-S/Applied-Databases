select p.personname,c.name,
  CASE
    WHEN (DATEDIFF(dateleft, datearrived))< 20 THEN "Short"
    WHEN (DATEDIFF(dateLeft, dateArrived)) BETWEEN  20 AND 99 THEN "Long"
    WHEN (DATEDIFF(dateleft, datearrived))>99 THEN "Very Long"
   END AS "Stay Length"
   from hasvisitedcity
   join person  as p on hasvisitedcity.personID=p.personID
   join city  as c on hasvisitedcity.cityID=c.ID
   order by p.personname,c.name;